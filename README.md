# 剑魄 - 击剑对战游戏

一个基于 React + TypeScript + Canvas 的击剑对战游戏，支持单机 AI 对战和局域网联机对战。

## 📖 快速导航

- **🚀 [快速开始](./快速开始.md)** - 3 分钟快速上手
- **👶 [新手完整指南](./BEGINNER_GUIDE.md)** - 从零开始的详细教程
- **🌐 [发布到网页](./DEPLOY_TO_WEB.md)** - 让游戏在线可玩
- **🎮 [联机功能说明](./MULTIPLAYER_GUIDE.md)** - 局域网对战详解

> 💡 **新手提示**：如果是第一次使用，建议先看 [快速开始](./快速开始.md)！

## 功能特点

- 🎮 精致的击剑战斗系统（刺击、斩击、冲刺、防御墙等）
- 🤖 四个难度等级的 AI 对手（初入江湖、略有小成、一代宗师、剑圣）
- 🌐 局域网联机对战模式
- 🎨 优雅的水墨风格视觉设计
- 🎵 动态音效系统

## 安装依赖

```bash
npm install
```

## 运行方式

### 🚀 Windows 用户 - 超简单方式（推荐）

**单人玩：**
- 双击 `启动游戏.bat`
- 浏览器会自动打开游戏

**局域网联机：**
- 房主双击 `启动联机服务器.bat`
- 所有玩家双击 `启动游戏.bat`

**一键启动（服务器+游戏）：**
- 双击 `一键启动（服务器+游戏）.bat`

### 📝 命令行方式

#### 单机模式

1. 启动开发服务器：
   ```bash
   npm run dev
   ```

2. 在浏览器中打开 `http://localhost:5173`

3. 选择难度开始游戏

### 局域网联机模式

#### 方法一：分别启动（推荐）

1. 在一台电脑上启动 WebSocket 服务器（服务器端）：
   ```bash
   npm run server
   ```
   服务器默认运行在端口 3001，记下这台电脑的局域网 IP 地址（如 192.168.1.100）

2. 在所有参与游戏的电脑上启动游戏客户端：
   ```bash
   npm run dev
   ```

3. 在浏览器中打开 `http://localhost:5173`

4. 点击"局域网对战"按钮

5. 输入服务器地址（如 `http://192.168.1.100:3001`）并连接

6. 一个玩家创建房间，另一个玩家输入房间 ID 加入

#### 方法二：同时启动

在服务器端电脑上同时启动服务器和客户端：
```bash
npm run dev:all
```

## 游戏操作

- **左键** - 刺击（突刺攻击）
- **右键** - 斩击（挥砍攻击）
- **Q** - 防御墙（消耗体力创建防御）
- **空格** - 冲刺闪避
- **Shift** - 疾跑
- **E** - 进入心流模式（重剑风格专属）
- **WASD** - 移动

## 游戏风格

- **重剑无锋** - 一击必杀，拥有心流模式，攻守兼备
- **快剑绝影** - 双倍生命，快速移动，以快制胜

## 局域网联机说明

### 网络要求

- 所有玩家必须在同一局域网内
- 确保防火墙允许端口 3001 和 5173 的通信

### 获取本机 IP 地址

**Windows:**
```bash
ipconfig
```
查找 "IPv4 地址"

**Mac/Linux:**
```bash
ifconfig
# 或
ip addr show
```
查找类似 192.168.x.x 的地址

### 房间系统

- 房主创建房间后会获得一个 6 位房间 ID
- 其他玩家使用房间 ID 加入
- 房间最多支持 2 名玩家
- 房主点击准备后等待对手加入，双方都准备好后游戏自动开始

## 技术栈

- React 19
- TypeScript
- Vite
- Socket.io（WebSocket 通信）
- Canvas 2D（游戏渲染）
- Express（WebSocket 服务器）

## 项目结构

```
cabin_game/
├── components/
│   ├── FencingGame.tsx      # 主游戏组件
│   └── MultiplayerMenu.tsx  # 联机菜单组件
├── utils/
│   └── NetworkManager.ts    # 网络管理器
├── server.js                # WebSocket 服务器
├── App.tsx                  # 应用入口
└── package.json
```

## 开发说明

### 构建生产版本

```bash
npm run build
```

### 预览生产版本

```bash
npm run preview
```

## 故障排除

### 无法连接到服务器

1. 检查服务器是否正在运行（`npm run server`）
2. 确认防火墙设置允许端口 3001
3. 验证 IP 地址是否正确
4. 确保所有设备在同一局域网内

### 游戏卡顿

1. 检查网络延迟
2. 关闭其他占用网络的应用
3. 确保服务器性能足够

## 许可证

本项目基于原 GAMEONE 项目开发，添加了局域网联机功能。
